(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{30:function(e,t,a){},49:function(e,t,a){e.exports=a.p+"static/media/ezgif.com-crop.0d28c576.gif"},54:function(e,t,a){e.exports=a(97)},59:function(e,t,a){},77:function(e,t,a){},82:function(e,t,a){},97:function(e,t,a){"use strict";a.r(t);var n=a(1),o=a.n(n),r=a(25),c=a.n(r);a(59),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var l=a(3),i=a(4),s=a(9),u=a(10),p=a(27),m=a(5),d=(a(30),a(53)),h=a(12),v=a(0),b=a.n(v),f=a(8),g=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props.perc||0,t=this.props.percc||0,a=this.props.perccc||0;return o.a.createElement("svg",{width:"80px",height:"80px",viewBox:"0 0 50 50",className:"donut","aria-labelledby":"beers-title beers-desc",role:"img"},o.a.createElement("circle",{className:"donut-hole",cx:"12",cy:"8",r:"4",fill:"white",role:"presentation"}),o.a.createElement("circle",{className:"donut-ring",cx:"12",cy:"8",r:"5",fill:"transparent",stroke:"#d2d3d4",strokeWidth:"5",role:"presentation"}),o.a.createElement("circle",{className:"donut-segment",cx:"12",cy:"8",r:"5",fill:"transparent",stroke:"#ce4b99",strokeWidth:"5",strokeDasharray:"".concat(t,", ").concat(a),strokeDashoffset:"0","aria-labelledby":"donut-segment-1-title donut-segment-1-desc"}),o.a.createElement("g",{className:"chart-text"},o.a.createElement("text",{className:"chart-number",x:"40%",y:"25%"},e)),o.a.createElement("path",{d:"M12 10c-1.104 0-2-.896-2-2s.896-2 2-2 2 .896 2 2-.896 2-2 2m0-5c-1.657 0-3 1.343-3 3s1.343 3 3 3 3-1.343 3-3-1.343-3-3-3m-7 2.602c0-3.517 3.271-6.602 7-6.602s7 3.085 7 6.602c0 3.455-2.563 7.543-7 14.527-4.489-7.073-7-11.072-7-14.527m7-7.602c-4.198 0-8 3.403-8 7.602 0 4.198 3.469 9.21 8 16.398 4.531-7.188 8-12.2 8-16.398 0-4.199-3.801-7.602-8-7.602"}))}}]),a}(n.Component),E=a(16),y=a.n(E),k=(new b.a.Icon({iconUrl:"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.4/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),new b.a.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.4/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})),w=new b.a.divIcon({className:"custom-div-icon",html:"<div style='background-color:#000000;' class='marker-pin'></div>",iconSize:[10,10],iconAnchor:[-6,-15]});function j(e,t,a){return new b.a.divIcon({className:"custom-icon",html:y.a.renderToString(o.a.createElement(g,{perc:e,percc:t,perccc:a})),iconAnchor:[18,28],popupAnchor:[0,-30]})}var O=a(26),S=a.n(O);var N=function(e){var t={method:"post",url:"https://terjack.space/state",data:JSON.stringify(e),responseType:"json"};return S()(t).then((function(e){console.log(e.data),console.log("here we go station state!!!!")})).catch((function(e){console.log(e)})),null},x=(a(77),a(22)),C=a(24),D=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props.name||0,t=this.props.meca||0,a=this.props.elec||0,n=(this.props.ava,this.props.libre||0),r=this.props.broke_m||0,c=this.props.broke_e||0;return o.a.createElement("body",null,o.a.createElement("div",{className:"table-title"},o.a.createElement("h3",null,e)),o.a.createElement("table",{className:"table-fill"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",{className:"text-title"},"V\xe9lib'"),o.a.createElement("th",null," ",o.a.createElement(x.a,{icon:C.b,size:"2x"})," "),o.a.createElement("th",null," ",o.a.createElement(x.a,{icon:C.c,size:"2x"})," "))),o.a.createElement("tbody",{className:"table-hover"},o.a.createElement("tr",null,o.a.createElement("td",{className:"ava"}," ",o.a.createElement(x.a,{icon:C.a,size:"2x",color:"green"})," m\xe9ca "),o.a.createElement("td",{className:"text-left"},t),o.a.createElement("td",{className:"text-left"},r)),o.a.createElement("tr",null,o.a.createElement("td",{className:"ava"}," ",o.a.createElement(x.a,{icon:C.a,size:"2x",color:"blue"})," \xe9lec"),o.a.createElement("td",{className:"text-left"},a),o.a.createElement("td",{className:"text-left"},c)))),o.a.createElement("div",{className:"table-subtitle"},o.a.createElement("h4",null,"Il reste ",o.a.createElement("b",{className:"ava"},n)," places disponibles!")))}}]),a}(n.Component);function P(e,t){var a=b.a.DomUtil.create("button","",t);return a.setAttribute("type","button"),a.innerHTML=e,a}function U(e,t,a,n){var o="location.href='https://terjack.space/qrcode"+n+"/?"+a.toString()+"'",r=b.a.DomUtil.create("button","",t);return r.setAttribute("type","button"),r.setAttribute("onclick",o),r.innerHTML=e,r}function L(e,t){var a=b.a.DomUtil.create("text","",t);return a.innerHTML=e,a}function z(e,t,a,n,r,c,l,i,s,u,p,m){var d=s-(m+p),h=d/u*(44/7*5),v=a-m,f=n-p,g=b.a.DomUtil.create("div","butclass"),E=(L(y.a.renderToString(o.a.createElement(D,{name:t,meca:v,elec:f,ava:d,libre:r,broke_e:p,broke_m:m})),g),P("Signaler la station",g)),k=P("Signaler un v\xe9lib",g),w=b.a.DomUtil.create("div",""),O=(L("station active",w),P("Oui",w)),S=P("Non",w),x=b.a.DomUtil.create("div",""),C=(L("le v\xe9lib est",x),U("M\xe9canique",x,l,"M")),z=U("\xc9lectrique",x,l,"E"),M=b.a.DomUtil.create("div",""),T=(L("<div><h2>"+t+"</h2><p>NON ACTIVE!!!</p></div>",M),P("Signaler un changement",M)),_=b.a.DomUtil.create("div",""),A=(L(y.a.renderToString(o.a.createElement("html",null)),_),new b.a.markerClusterGroup),W={maxWidth:"1000",className:"custom-popup"},I=new b.a.marker(c,{icon:j(d,h,44/7*5)});"OUI"===i?(I.addTo(A),I.bindPopup(g,W).openPopup()):(console.log("change in state!!!!"),I.addTo(A),I.bindPopup(M,W).openPopup()),e.addLayer(A);var B=b.a.DomUtil.get(T);b.a.DomEvent.addListener(B,"click",(function(e){I.closePopup(),I.bindPopup(w,W).openPopup()}));var K=b.a.DomUtil.get(E);b.a.DomEvent.addListener(K,"click",(function(e){I.closePopup(),I.bindPopup(w,W).openPopup()}));var q=b.a.DomUtil.get(S);b.a.DomEvent.addListener(q,"click",(function(e){I.closePopup(),console.log("station active:NON"),N({velib:"","station active":"NON",code:l,vKey:""}),I.bindPopup(M,W).openPopup()}));var G=b.a.DomUtil.get(O);b.a.DomEvent.addListener(G,"click",(function(e){I.closePopup(),console.log("station active:OUI"),N({velib:"","station active":"OUI",code:l,vKey:""}),I.bindPopup(g,W).openPopup()}));var R=b.a.DomUtil.get(k);b.a.DomEvent.addListener(R,"click",(function(e){I.closePopup(),I.bindPopup(x,W).openPopup()}));var J=b.a.DomUtil.get(C);b.a.DomEvent.addListener(J,"click",(function(e){I.closePopup()}));var H=b.a.DomUtil.get(z);return b.a.DomEvent.addListener(H,"click",(function(e){I.closePopup()})),function(){e.removeLayer(A)}}a(44);a(82);a(83),a(44);var M=function(e){var t=Object(f.c)(),a=e.pro;return console.log(a),Object(n.useEffect)((function(){var e=new b.a.markerClusterGroup;Object.entries(a).map((function(t){var a=Object(h.a)(t,2),n=(a[0],a[1]),r=n.fields.name,c=n.fields.mechanical.toString(),l=n.fields.ebike.toString(),i=n.fields.numdocksavailable.toString(),s=n.fields.coordonnees_geo,u=n.fields.capacity,p=n.fields.numbikesavailable,m=n.fields.broke_ebike.length,d=n.fields.broke_mechanical.length;!function(e,t,a,n,r,c,l,i,s,u){var p=i-(u+s),m=p/l*(44/7*5),d=t-u,h=a-s,v=b.a.DomUtil.create("div","butclass");L(y.a.renderToString(o.a.createElement(D,{name:e,meca:d,elec:h,ava:p,libre:n,broke_e:s,broke_m:u})),v),new b.a.marker(c,{icon:j(p,m,44/7*5)}).addTo(r).bindPopup(v,{maxWidth:"500",className:"custom-popup"}).openPopup()}(r,c,l,i,e,s,u,p,m,d)}));var n=t.layerContainer||t.map;return n.addLayer(e),function(){n.removeLayer(e)}}),[a]),null},T=a(99),_=a(101),A=a(100),W=a(48);var I=function(e,t,a,n){var o={method:"post",url:"https://terjack.space/coor",data:JSON.stringify(a),responseType:"json"};return S()(o).then((function(o){console.log(o.data),console.log("here we go!!!!"),Object.entries(o.data).map((function(a){var o=Object(h.a)(a,2),r=o[0],c=o[1],l=c.name,i=c.mechanical.toString(),s=c.ebike.toString(),u=c.stationcode,p=c.numdocksavailable.toString(),m=c.coordonnees_geo;console.log(m);var d=c.is_returning,v=c.capacity,b=c.numbikesavailable,f=c.broke_ebike.length;console.log(f);var g=c.broke_mechanical.length;"0"===r?(t.spliceWaypoints(n,1,m),z(e,l,i,s,p,m,u,d,b,v,f,g)):z(e,l,i,s,p,m,u,d,b,v,f,g)})),2===n&&t.spliceWaypoints(3,1,a)})).catch((function(e){console.log(e)})),function(){e.removeControl(t)}};a(84);a(85),a(87);var B=function(){var e=Object(f.c)(),t=Object(n.useRef)(0);return Object(n.useEffect)((function(){var a=b.a.Routing.control({show:!1,geocoder:b.a.Control.Geocoder.nominatim(),router:new b.a.Routing.osrmv1({serviceUrl:"https://terjack.space/route/v1",profile:"cycling"}),routeWhileDragging:!0,reverseWaypoints:!0,createMarker:function(e,t,a){return 0===e?b.a.marker(t.latLng,{icon:k}).bindPopup("start").openPopup():3===e?b.a.marker(t.latLng,{icon:k}).bindPopup("end").openPopup():b.a.marker(t.latLng,{icon:w})}}),n=e.layerContainer||e.map;n.addControl(a);var o=b.a.Routing.errorControl(a);n.addControl(o);var r=Object(W.geosearch)({position:"topleft",useMapBounds:!1,zoomToResult:!1,expanded:!0,placeholder:"entre ta destination!",title:"Destination"});return n.addControl(r),r.on("results",(function(e){console.log(e),I(n,a,e.latlng,2)})),n.on("locationfound",(function(e){console.log(e.latlng),0===t.current&&(console.log(t),a.spliceWaypoints(0,1,e.latlng),I(n,a,e.latlng,1),t.current+=1)})),n.on("locationerror",(function(e){alert(e.message)})),function(){n.removeControl(a),n.removeControl(o),n.removeControl(r)}}),[]),null};a(88);var K=function(){var e=Object(f.c)();return Object(n.useEffect)((function(){var t=new b.a.Control.Gps({autoActive:!0,autoCenter:!0,maxZoom:17,autoUpdate:1,position:"bottomleft"}),a=e.layerContainer||e.map;return a.addControl(t),function(){a.removeControl(t)}})),null},q=a(49),G=a.n(q),R=function(){return fetch.apply(void 0,arguments).then((function(e){return e.json()}))},J=[48.8566,2.3522];var H=function(){var e=Object(d.a)("https://terjack.space/popup",{fetcher:R}),t=e.data;if(e.error)return o.a.createElement("h1",null,"Something went wrong!");if(!t)return o.a.createElement("div",null,o.a.createElement("h1",null,"Loading... "),o.a.createElement("h1",null,o.a.createElement("img",{src:G.a,width:"400",height:"400",id:"masuperimage"})));var a=t;return o.a.createElement(T.a,{center:J,zoom:12,zoomControl:!1},o.a.createElement(B,null),o.a.createElement(_.a,{position:"bottomleft"},o.a.createElement(_.a.BaseLayer,{name:"Normal"},o.a.createElement(A.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'})),o.a.createElement(_.a.BaseLayer,{checked:!0,name:"Gris"},o.a.createElement(A.a,{url:"http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attribution:'\xa9 <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, \xa9 <a href="http://cartodb.com/attributions">CartoDB</a>'})),o.a.createElement(_.a.Overlay,{name:"Montrer toutes les stations"},o.a.createElement(M,{pro:a}))),o.a.createElement(K,null))},Q=a(14),V=a(31),Z=a.n(V),$=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={delay:500,result:"No result"},n.handleScan=n.handleScan.bind(Object(Q.a)(n)),n}return Object(i.a)(a,[{key:"handleScan",value:function(e){e&&(this.setState({result:e}),console.log({velib:"M","station active":"",code:window.location.search,vKey:this.state.result}),N({velib:"M","station active":"",code:window.location.search,vKey:this.state.result}),this.props.history.push("/"))}},{key:"handleError",value:function(e){console.error(e)}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("p",null,"Scannez le QrCode situ\xe9 sur le cadre du v\xe9lib' cass\xe9!"),o.a.createElement("p",null,"retournez la selle pour pr\xe9venir les autres utilisateurs please ;)"),o.a.createElement(Z.a,{delay:this.state.delay,style:{height:240,width:320},onError:this.handleError,onScan:this.handleScan}))}}]),a}(n.Component),F=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={delay:500,result:"No result"},n.handleScan=n.handleScan.bind(Object(Q.a)(n)),n}return Object(i.a)(a,[{key:"handleScan",value:function(e){e&&(this.setState({result:e}),console.log({velib:"E","station active":"",code:window.location.search,vKey:this.state.result}),N({velib:"E","station active":"",code:window.location.search,vKey:this.state.result}),this.props.history.push("/"))}},{key:"handleError",value:function(e){console.error(e)}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("p",null,"Scannez le QrCode situ\xe9 sur le cadre du v\xe9lib' cass\xe9!"),o.a.createElement("p",null,"retournez la selle pour pr\xe9venir les autres utilisateurs please ;)"),o.a.createElement(Z.a,{delay:this.state.delay,style:{height:240,width:320},onError:this.handleError,onScan:this.handleScan}))}}]),a}(n.Component),X=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return o.a.createElement(p.a,null,o.a.createElement("div",null,o.a.createElement(m.c,null,o.a.createElement(m.a,{exact:!0,path:"/",component:H}),o.a.createElement(m.a,{path:"/qrcodeE",component:F}),o.a.createElement(m.a,{path:"/qrcodeM",component:$}))))}}]),a}(n.Component);c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(p.a,null,o.a.createElement(X,null))),document.getElementById("map")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[54,1,2]]]);
//# sourceMappingURL=main.f8d3560b.chunk.js.map